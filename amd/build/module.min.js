define("block_quizonepagepaginate/module",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/**
   * JS for this plugin.
   *
   * @copyright   IntegrityAdvocate.com
   * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
   class block_quizonepagepaginate{constructor(t){const e=this,o=e.constructor.name+".constructor";if(e.shouldUseThisBlockJs()){if(isNaN(t))throw o+"::Invalid value passed for param questionsperpage";e.questionsperpage=parseInt(t),e.firstQuestionToShow=0,e.eltQuestionsSelector="#page-mod-quiz-attempt #responseform .que",e.eltQuizFinishAttemptButtonSelector="#responseform .submitbtns .mod_quiz-next-nav",e.eltBqoppButtonPrev=e.constructor.name+"-prev",e.eltBqoppButtonNext=e.constructor.name+"-next",e.arrQuestions=[]}}run(){let t=!1;const e=this;e.constructor.name;if(!e.shouldUseThisBlockJs())return void 0;e.getAllQuestions(),e.addNextPrevButtons(),window.addEventListener("hashchange",e.handleAnchorChange);const o=e.getAnchorQuestionIndex(document.URL);o>=0&&(e.firstQuestionToShow=o),e.hideShowQuestions(e.firstQuestionToShow,e.questionsperpage)}shouldUseThisBlockJs(){const t=this;t.constructor.name;return null==typeof t.shouldUseThisBlockJsVal||(t.shouldUseThisBlockJsVal="page-mod-quiz-attempt"===document.body.id),t.shouldUseThisBlockJsVal}getAnchorQuestionIndex(t=""){const e=this;e.constructor.name;let o=-1;const n=e.getAnchor(t);if(!n||n.length<12)return o;const s=e.getAnchorQuestionNr(n);return s?(o=e.findQuestionIndexFromQuestionNr(s),o):o}getAnchor(t=""){let e=t.split("#")[1];return e||""}getAnchorQuestionNr(t=""){let e=!1;this.constructor.name;let o="";if(t&&t.length>2){const n=t.match(/(question-\d+-\d+)/);e,n&&(o=n[1])}return o}findQuestionIndexFromQuestionNr(t=""){let e=!1;const o=this,n=o.constructor.name+".findQuestionIndexFromQuestionNr";let s=-1;return t?o.arrQuestions.length<1?(window.console.log(n+"::arrQuestions is empty so return not found"),s):(o.arrQuestions.forEach((function(e,o){e.id!==t||(s=o)})),s):(window.console.log(n+"::Invalid value passed for param questionNr so return not found"),s)}getAllQuestions(){const t=this;t.constructor.name;t.arrQuestions=document.querySelectorAll(t.eltQuestionsSelector)}hideShowQuestions(t=0,e){let o=!1;const n=M.block_quizonepagepaginate;n.constructor.name;const s=t+e;let r=0;n.arrQuestions.forEach((function(e,o){o>=t&&o<s&&r<n.questionsperpage?(n.setDisplayVal(e,"block"),r++):n.setDisplayVal(e,"none")}))}scrollToQuestion(){document.querySelector("#responseform").scrollIntoView({behavior:"smooth"})}setDisplayVal(t,e){t.style.display=e}addNextPrevButtons(){let t=!1;const e=this,o=e.constructor.name+".addNextPrevButtons";const n=document.querySelector(e.eltQuizFinishAttemptButtonSelector);if(null===n)throw o+"::No button found to clone";const s=[{key:"previous",component:"core"},{key:"next",component:"core"}];require(["core/str"],(function(t){t.get_strings(s).then((function(t){e.addPrevNextButton(n,"prev",t).addEventListener("click",e.buttonClickedPrev);e.addPrevNextButton(n,"next",t).addEventListener("click",e.buttonClickedNext)}))}))}addPrevNextButton(t,e,o){const n=M.block_quizonepagepaginate;n.constructor.name;const s=t.cloneNode(),r="prev"===e,i=r?n.eltBqoppButtonPrev:n.eltBqoppButtonNext,u=o[r?0:1];return s.setAttribute("id",i),s.setAttribute("class",s.getAttribute("class").replace("btn-primary","btn-secondary")),s.setAttribute("name",i),s.setAttribute("type",i),s.setAttribute("value",u),s.setAttribute("data-initial-value",u),t.parentNode.insertBefore(s,t)}buttonClickedPrev(){const t=M.block_quizonepagepaginate;t.constructor.name;t.triggerAutosave(),t.updateVisibleQuestionRange(!1),t.hideShowQuestions(t.firstQuestionToShow,t.questionsperpage),t.scrollToQuestion()}buttonClickedNext(){const t=M.block_quizonepagepaginate;t.constructor.name;t.triggerAutosave(),t.updateVisibleQuestionRange(!0),t.hideShowQuestions(t.firstQuestionToShow,t.questionsperpage),t.scrollToQuestion()}triggerAutosave(){const t=M.block_quizonepagepaginate.constructor.name+".triggerAutosave";window.console.log(t+"::Started");try{window.console.log(t+"::About to trigger autosave"),M.mod_quiz.autosave.save_changes()}catch(e){window.console.log(t+"::autosave is disabled")}}updateVisibleQuestionRange(t=!0){let e=!1;const o=M.block_quizonepagepaginate,n=o.constructor.name+".updateVisibleQuestionRange";const s=o.questionsperpage,r=o.arrQuestions.length;if(t){const t=o.firstQuestionToShow+s;e,o.firstQuestionToShow=t+s<r?t:r-s}else{const t=o.firstQuestionToShow-s;window.console.log(n+"::Proposed start of the next set of questions=",t),o.firstQuestionToShow=t<0?0:t}}handleAnchorChange(t){let e=!1;const o=M.block_quizonepagepaginate;o.constructor.name;const n=t.target||t.srcElement;let s="";if(o.isWindowObj(n)&&(s=window.location.href),s.length<1){if(!n.closest("#mod_quiz_navblock"))return void 0;const t=n.closest("a.qnbutton");if(!t)return void 0;s=t.href}if(s.length<1)return void 0;const r=o.getAnchorQuestionIndex(s);r>=0&&(o.firstQuestionToShow=r),o.hideShowQuestions(o.firstQuestionToShow,o.questionsperpage)}isWindowObj(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}}
   _exports.init=questionsperpage=>{try{M.block_quizonepagepaginate=new block_quizonepagepaginate(questionsperpage),M.block_quizonepagepaginate.run()}catch(e){window.console.error(e)}}
}));

//# sourceMappingURL=module.min.js.map